<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon" href="fav.png" type="image/x-icon">
  <title>MiniFlix Player</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css" />

  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      user-select: none;
    }
    
    body,
    html {
      width: 100%;
      height: 100%;
      background-color: #000;
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
    }
    
    .video-container {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background: #000;
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 9999;
    }
    
    
    .video {
      width: 100%;
      height: 100%;
    }
    
    .center-controls {
      position: absolute;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 40px;
    }
    
    .control-btn {
      background: rgba(0, 0, 0, 0.5);
      border: none;
      color: #fff;
      font-size: 3em;
      cursor: pointer;
      padding: 10px;
      border-radius: 50%;
      background: transparent;
      border: none;
    }
    
    .bottom-controls {
      position: absolute;
      bottom: 20px;
      left: 0;
      right: 0;
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 10px;
      background: rgba(0, 0, 0, 0.5);
      color: #fff;
      margin-left: 20px;
      margin-right: 20px;
    }
    
    .progress-bar {
      flex: 1;
      margin: 0 10px;
    }
    
    .time {
      font-size: 1.2em;
    }
    
    .volume-control {
      position: relative;
      display: flex;
      align-items: center;
      gap: 5px;
      padding: 2px 10px;
    }
    
    .volume-icon {
      cursor: pointer;
      font-size: 1.5em;
    }
    
    .volume-bar {
      position: absolute;
      bottom: 35px;
      right: 22px;
      width: 10px;
      height: 80px;
      display: flex;
      flex-direction: column-reverse;
      align-items: center;
      background-color: white;
      border-radius: 5px;
      opacity: 0;
      transition: opacity 0.3s;
    }
    
    .volume-control:hover .volume-bar {
      opacity: 1;
    }
    
    .volume-indicator {
      position: absolute;
      bottom: 0;
      width: 100%;
      height: 100%;
      background-color: #4caf50;
      right: 0px;
    }
    
    .volume-handle {
      width: 15px;
      height: 15px;
      background-color: #fff;
      border-radius: 50%;
      cursor: pointer;
      position: absolute;
      top: 0;
      right: -6px;
      transform: translateX(-25%);
    }
    
    .video {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    
    .fa-right-from-bracket {
      color: white;
      font-size: 1.23em;
      cursor: pointer;
      padding-left: 6px;
    }
    
    .menu-icon {
      font-size: 1.3em;
      cursor: pointer;
      padding-left: 17px;
    }
    
    .menu {
      display: none;
      position: absolute;
      bottom: 60px;
      right: -10px;
      padding: 10px;
      border: 1px solid white;
      background-color: white;
    }
    
    .menu.active {
      display: block;
    }
    
    .menu-item {
      color: black;
      padding: 13px;
      cursor: pointer;
    }
    
    .menu-item:hover {
      background-color: rgba(20, 17, 17, 0.2);
    }
    
    .hidden {
      opacity: 0;
      pointer-events: none;
    }
    
    .speed {
      width: 150px;
      text-align: center;
      display: none;
      position: absolute;
      bottom: 60px;
      right: -10px;
      padding: 10px;
      border: 1px solid white;
      background-color: white;
      max-height: 250px;
      overflow-y: auto;
    }
    
    .Quality {
      width: 150px;
      text-align: center;
      display: none;
      position: absolute;
      bottom: 60px;
      right: -10px;
      padding: 10px;
      border: 1px solid white;
      background-color: white;
      max-height: 250px;
      overflow-y: auto;
    }
    
    .speed-item {
      color: black;
      padding: 17px;
      cursor: pointer;
    }
    
    .quality-item {
      color: black;
      padding: 17px;
      cursor: pointer;
    }
    
    .speed.active {
      display: block;
    }
    
    .Quality.active {
      display: block;
    }
    
    .speed-item:hover {
      background-color: rgba(20, 17, 17, 0.2);
    }
    
    .quality-item:hover {
      background-color: rgba(20, 17, 17, 0.2);
    }
    
    .fa-arrow-left {
      padding: 0;
      margin: 0;
      position: absolute;
      top: 11.8%;
      left: 12%;
      font-size: 15px;
    }
    
    .fullscreen-btn {
      font-size: 1.23em;
      background: transparent;
      color: white;
      margin-right: 10px;
      border: none;
      cursor: pointer;
    }
    </style>

</head>

<body>

  <div class="video-container" id="videoContainer">
    <video id="video" class="video"></video>

    <div class="center-controls">
      <button id="prevVideo" class="control-btn"><i class="fa-solid fa-backward-fast"></i></button>
      <button id="playPause" class="control-btn play">‚ñ∫</button>
      <button id="nextVideo" class="control-btn"><i class="fa-solid fa-forward-fast"></i></button>
    </div>

    <div class="bottom-controls">
      <span id="currentTime" class="time">0:00</span>
      <input id="progressBar" type="range" class="progress-bar" value="0">
      <span id="remainingTime" class="time">0:00</span>
      <div class="volume-control">
        <span id="volumeIcon" class="volume-icon">üîä</span>
        <div id="volumeBar" class="volume-bar">
          <div id="volumeIndicator" class="volume-indicator"></div>
          <div id="volumeHandle" class="volume-handle"></div>
        </div>
      </div>
      <button id="fullscreenButton" class="fullscreen-btn">‚õ∂</button>
      <i class="fa-solid fa-right-from-bracket" onclick="location.href='Home.html'"></i>
      <i class="fa-solid fa-ellipsis-vertical menu-icon" id="menuIcon"></i>
      <div id="menu" class="menu">
        <div class="menu-item" id="quality">Quality</div>
        <div class="menu-item" id="playback-speed">Playback Speed</div>
      </div>
      <div id="speed" class="speed">
        <div class="speed-item">Options</div>
        <i class="fa-solid fa-arrow-left speed-item"></i>
        <div class="speed-item" data-speed="0.25">0.25x</div>
        <div class="speed-item" data-speed="0.5">0.5x</div>
        <div class="speed-item" data-speed="0.75">0.75x</div>
        <div class="speed-item" data-speed="1">Normal</div>
        <div class="speed-item" data-speed="1.25">1.25x</div>
        <div class="speed-item" data-speed="1.5">1.5x</div>
        <div class="speed-item" data-speed="1.75">1.75x</div>
        <div class="speed-item" data-speed="2">2x</div>
      </div>
      <div id="Quality" class="Quality">
        <div class="quality-item">1080p</div>
        <div class="quality-item">720p</div>
        <div class="quality-item">480p</div>
        <div class="quality-item">360p</div>
        <div class="quality-item">(Auto)</div>
      </div>
    </div>
  </div>

  <script>
    const video = document.getElementById('video');
    const playPauseButton = document.getElementById('playPause');
    const progressBar = document.getElementById('progressBar');
    const currentTimeDisplay = document.getElementById('currentTime');
    const remainingTimeDisplay = document.getElementById('remainingTime');
    const volumeBar = document.getElementById('volumeBar');
    const volumeIndicator = document.getElementById('volumeIndicator');
    const volumeHandle = document.getElementById('volumeHandle');
    const nextVideoButton = document.getElementById('nextVideo');
    const prevVideoButton = document.getElementById('prevVideo');
    const menuIcon = document.getElementById('menuIcon');
    const menu = document.getElementById('menu');
    const Quality = document.getElementById('Quality');
    const quality = document.getElementById('quality');
    const playbackSpeedMenuItem = document.getElementById('playback-speed');
    const speedMenu = document.getElementById('speed');
    const videoContainer = document.getElementById('videoContainer');
    const centerControls = document.querySelector('.center-controls');
    const bottomControls = document.querySelector('.bottom-controls');

    function hideControls() {
      centerControls.style.opacity = '0';
      bottomControls.style.opacity = '0';
    }

    function showControls() {
      centerControls.style.opacity = '1';
      bottomControls.style.opacity = '1';
      clearTimeout(hideControlsTimeout);
      hideControlsTimeout = setTimeout(hideControls, 3000);
    }

    video.addEventListener('play', () => {
      hideControlsTimeout = setTimeout(hideControls, 3000);
    });

    videoContainer.addEventListener('mousemove', showControls);

    video.volume = 1.0;
    volumeIndicator.style.height = '100%';

    fetch('videos.json')
        .then(response => response.json())
        .then(data => {
            videoList = data.videos; // Get video list from JSON
            loadVideo(currentVideoIndex); // Load the first video
        })
        .catch(error => console.error('Error loading video list:', error));

    function loadVideo(index) {
        video.src = videoList[index];
        video.play();
        playPauseButton.textContent = '‚ùö‚ùö';
    }

    nextVideoButton.addEventListener('click', () => {
        currentVideoIndex = (currentVideoIndex + 1) % videoList.length;
        loadVideo(currentVideoIndex);
    });

    prevVideoButton.addEventListener('click', () => {
        currentVideoIndex = (currentVideoIndex - 1 + videoList.length) % videoList.length;
        loadVideo(currentVideoIndex);
    });

    let videoList = [];

    let currentVideoIndex = 0;

    const urlParams = new URLSearchParams(window.location.search);
    const videoSrc = urlParams.get('video');

    if (videoSrc && videoList.includes(videoSrc)) {
      video.src = videoSrc;
      currentVideoIndex = videoList.indexOf(videoSrc);
    } else {
      video.src = videoList[0];
    }

    function enterFullscreen() {
      if (videoContainer.requestFullscreen) {
        videoContainer.requestFullscreen();
      } else if (videoContainer.webkitRequestFullscreen) {
        videoContainer.webkitRequestFullscreen();
      } else if (videoContainer.msRequestFullscreen) {
        videoContainer.msRequestFullscreen();
      }
    }
    fullscreenButton.addEventListener('click', () => {
      if (document.fullscreenElement) {
        document.exitFullscreen();
      } else {
        enterFullscreen();
      }
    });

    document.addEventListener('fullscreenchange', () => {
      if (!document.fullscreenElement) {
      }
    });

    playPauseButton.addEventListener('click', () => {
      if (video.paused) {
        video.play();
        playPauseButton.textContent = '‚ùö‚ùö';
      } else {
        video.pause();
        playPauseButton.textContent = '‚ñ∫';
      }
    });

    video.addEventListener('timeupdate', () => {
      const progress = (video.currentTime / video.duration) * 100;
      progressBar.value = progress;
      currentTimeDisplay.textContent = formatTime(video.currentTime);
      remainingTimeDisplay.textContent = formatTime(video.duration - video.currentTime);
    });

    progressBar.addEventListener('input', () => {
      const seekTime = (progressBar.value / 100) * video.duration;
      video.currentTime = seekTime;
    });

    volumeBar.addEventListener('mousedown', (e) => {
      let initialY = e.clientY;
      let initialHeight = volumeIndicator.offsetHeight;
      const onMouseMove = (e) => {
        const deltaY = initialY - e.clientY;
        let newHeight = initialHeight + deltaY;
        newHeight = Math.max(0, Math.min(newHeight, volumeBar.clientHeight));
        const volumeLevel = newHeight / volumeBar.clientHeight;
        video.volume = volumeLevel;
        volumeIndicator.style.height = `${newHeight}px`;
        volumeHandle.style.top = `${volumeBar.clientHeight - newHeight}px`;
      };
      document.addEventListener('mousemove', onMouseMove);
      document.addEventListener('mouseup', () => {
        document.removeEventListener('mousemove', onMouseMove);
      }, { once: true });
    });

    nextVideoButton.addEventListener('click', () => {
      currentVideoIndex = (currentVideoIndex + 1) % videoList.length;
      loadVideo(currentVideoIndex);
    });

    prevVideoButton.addEventListener('click', () => {
      currentVideoIndex = (currentVideoIndex - 1 + videoList.length) % videoList.length;
      loadVideo(currentVideoIndex);
    });

    menuIcon.addEventListener('click', () => {
      menu.classList.toggle('active');
    });

    playbackSpeedMenuItem.addEventListener('click', () => {
      speedMenu.classList.toggle('active');
    });

    document.querySelectorAll('.speed-item').forEach(item => {
      item.addEventListener('click', (event) => {
        const speedOption = event.target.getAttribute('data-speed');
        if (speedOption) {
          video.playbackRate = parseFloat(speedOption);
        }
        speedMenu.classList.remove('active');
      });
    });

    document.querySelectorAll('.quality-item').forEach(item => {
      item.addEventListener('click', (event) => {
        const qualityOption = event.target.textContent;
        console.log('Quality selected:', qualityOption);
        Quality.classList.remove('active');
      });
    });

    quality.addEventListener('click', () => {
      Quality.classList.toggle('active');
    });

    // Close menu when clicking outside of it
    document.addEventListener('click', (event) => {
      if (!menu.contains(event.target) && !menuIcon.contains(event.target)) {
        menu.classList.remove('active');
      }
      if (!Quality.contains(event.target) && !quality.contains(event.target)) {
        Quality.classList.remove('active');
      }
    });

    function loadVideo(index) {const urlParams = new URLSearchParams(window.location.search);
const videoSrc = urlParams.get('video');

if (videoSrc) {
    video.src = videoSrc;
    currentVideoIndex = videoList.indexOf(videoSrc); // Adjust as necessary
} else {
    // Handle default or error case
    console.error('No video source provided');
}
      video.play();
      playPauseButton.textContent = '‚ùö‚ùö';
    }

    function formatTime(seconds) {
      const mins = Math.floor(seconds / 60);
      const secs = Math.floor(seconds % 60).toString().padStart(2, '0');
      return `${mins}:${secs}`;
    }
  </script>

</body>

</html>